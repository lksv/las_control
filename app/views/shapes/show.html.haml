-if @shape&.source.respond_to?(:to_address)
  %h5.address= Array.wrap(@shape.source.to_address).join(', ')
  = cuzk_url(@shape.source, 'Katastr nemovitostí ')
  %br
  %br
%dl
  - @events.group_by(&:source).sort_by { |source, events| source.created_at }.each do |source, events|
    %dt
      %span.document-title
        - anchor = "addressBlock-#{events.first.address_block.id}"
        = link_to truncate(source.title.to_s, length: 70),
          polymorphic_path(source, anchor: anchor)
    %dd
      %span.from-date
        Ze dne
        = l(source.from_date, format: :short)
        - if source.document_storage
          [
          = link_to 'Archiv', source.document_storage.url
          ]
      - if events.size > 1
        %br
        = "Adresa je v textu odkazována #{events.size}."
        %br
        Přímý odkaz na všechny výskyty:
        - events.each_with_index do |event, idx|
          = link_to "#{idx + 1}. ", polymorphic_path(source, anchor: "addressBlock-#{event.address_block.id}")
